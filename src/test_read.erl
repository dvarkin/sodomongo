%%%-------------------------------------------------------------------
%%% @author Dmitry Omelechko <dvarkin@gmail.com>
%%% @copyright (C) 2016, Dmitry Omelechko
%%% @doc
%%%
%%% @end
%%% Created : 19 Aug 2016 by Dmitry Omelechko <dvarkin@gmail.com>
%%%-------------------------------------------------------------------
-module(test_read).

-define(IDLIMIT, 1000000).

%% API
-export([run/1]).

%%%===================================================================
%%% API
%%%===================================================================


run(Connection) ->
    Id = rand:uniform(?IDLIMIT),
    mc_worker_api:find_one(Connection, <<"odds">>, {<<"_id">>, Id}),
    metrics:notify({<<"total_rate">>, 1}),
    run(Connection).


%%--------------------------------------------------------------------
%% @doc
%% @spec
%% @end
%%--------------------------------------------------------------------

%%%===================================================================
%%% Internal functions
%%%===================================================================
